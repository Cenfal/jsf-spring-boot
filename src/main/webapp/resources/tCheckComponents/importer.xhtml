<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:composite="http://xmlns.jcp.org/jsf/composite"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

<!-- Muestra una fecha en formato dd-MM-yyyy -->
<h:body>
	<composite:interface>
		<composite:attribute name="elements" required="true"
			type="java.util.Collection" />
		<composite:attribute name="templatePath" />
		<composite:attribute name="fileUploadListener"
			method-signature="void listener(org.primefaces.event.FileUploadEvent)" />
		<composite:attribute name="action"
			method-signature="java.lang.String action()" />
	</composite:interface>

	<composite:implementation>

		<h:panelGroup id="importer">

			<ui:param name="hasAnyError"
				value="#{cc.attrs.elements.stream().anyMatch(e -> e.hasAnyError()).get()}" />

			<ui:param name="hasAnyWarning"
				value="#{cc.attrs.elements.stream().anyMatch(e -> e.hasAnyIssue()).get()}" />

			<h:panelGroup
				rendered="#{not empty cc.attrs.elements and hasAnyError}">
				<h:outputText styleClass="fa fa-close"
					style="color: #e61980; font-size:3em; margin-right: 15px;" />
				<h:outputText value="#{msg.IMPORT_FILE_ERRORS}"
					styleClass="invalid-value" />
			</h:panelGroup>

			<h:panelGroup
				rendered="#{not empty cc.attrs.elements and not hasAnyError and hasAnyWarning}">
				<h:outputText styleClass="fa fa-exclamation-triangle"
					style="color: orange; font-size:3em; margin-right: 15px;" />

				<h:outputText value="#{msg.IMPORT_FILE_WARNINGS}"
					styleClass="warning-value" />
			</h:panelGroup>

			<h:panelGroup id="dataTable"
				rendered="#{not empty cc.attrs.elements}">
				<div class="table-responsive">
					<composite:insertChildren />
				</div>
			</h:panelGroup>

			<h:panelGroup id="importControl">
				<h:panelGroup styleClass="panel"
					rendered="#{empty cc.attrs.elements}">
					<div class="panel-body panelDetail">
						<div class="col-xs-12">
							<h:outputLink rendered="#{not empty cc.attrs.templatePath}"
								value="#{cc.attrs.templatePath}"
								style="font-size: 14pt; float: right;">#{msg.TEMPLATE}</h:outputLink>

							<p:fileUpload fileUploadListener="#{cc.attrs.fileUploadListener}"
								mode="advanced" auto="true" sizeLimit="10000000"
								label="#{msg.OPERATIONS_FILE_UPLOAD}" update="importer" />
						</div>
					</div>
				</h:panelGroup>

				<ui:fragment rendered="#{not empty cc.attrs.elements}">
					<hr />
					<div class="row">
						<div class="container">
							<div class="col-md-7" />
							<div class="col-md-3 col-xs-6">
								<p:button value="#{msg.OPERATIONS_FILE_UPLOAD_RETRY}"
									styleClass="btn btn-default btn-lg" includeViewParams="true" />
							</div>
							<div class="col-md-2 col-xs-6">
								<p:commandButton value="#{msg.SAVE}" ajax="false"
									action="#{cc.attrs.action}" rendered="#{not hasAnyError}"
									styleClass="btn btn-default btn-lg" />
							</div>
						</div>
					</div>
				</ui:fragment>
			</h:panelGroup>
		</h:panelGroup>
	</composite:implementation>
</h:body>
</html>