<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:composite="http://xmlns.jcp.org/jsf/composite">

<composite:interface>
	<composite:attribute name="selectorClass" required="true" />
	<composite:attribute name="equipment" required="true" />
	<composite:attribute name="headWorkers" required="true" />
	<composite:attribute name="selectedWorker" required="true" />
	<composite:attribute name="hasWorker" />
	<composite:attribute name="update" required="true" />
	<composite:attribute name="action" required="true"
		method-signature="void action()" />
</composite:interface>

<composite:implementation>
	<div class="modal fade #{cc.attrs.selectorClass}" tabindex="-1"
		role="dialog" aria-labelledby="workerAssignationModalClass"
		aria-hidden="true" data-keyboard="false" data-backdrop="static">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<h:panelGroup id="content">
					<div class="modal-header"
						style="background-color: #DAE8EF; color: #003D50; border-bottom: 3px solid #C1D5DF">
						<button type="button" class="close" data-dismiss="modal">
							<i class="fa fa-times"></i>
						</button>
						<h4>
							<h:outputText
								value="#{viewUtils.joinWithCommas(bean._SelectedEquipment._Type, bean._SelectedEquipment._Brand, bean._SelectedEquipment._Model)}"
								style="font-weight:bold;" />
						</h4>
						<p>
							<h:outputText value="Código: " />
							<h:outputText value="#{cc.attrs.equipment._Code} "
								style="font-weight:bold;" />
							<h:outputText value="Nº de Serie: " style="margin-left:20px;"
								rendered="#{cc.attrs.equipment._SerialNumber != ''}" />
							<h:outputText value="#{cc.attrs.equipment._SerialNumber}"
								style="font-weight:bold;" />
						</p>
					</div>
					<div class="modal-body small-modal-body">
						<!-- WORKER AUTOCOMPLETE -->
						<div class="form-group form-group-sm" style="margin-bottom: 50px;">
							<label class="col-sm-3 control-label text-right">#{msg.WORKER}</label>
							<div class="col-sm-7">
								<p:selectOneMenu converter="omnifaces.SelectItemsConverter"
									filter="true" filterMatchMode="custom"
									filterFunction="skipAccentsContains" appendTo="@this"
									value="#{cc.attrs.selectedWorker}" style="width:100%;">
									<c:if test="#{cc.attrs.hasWorker}">
										<f:selectItem itemValue="#{null}" itemLabel="Desasignar" />
									</c:if>
									<c:if test="#{cc.attrs.headWorkers.isEmpty()}">
										<f:selectItem noSelectionOption="true"
											itemLabel="No existen trabajadores en esa organización" />
									</c:if>
									<f:selectItems value="#{cc.attrs.headWorkers}" var="worker"
										itemLabel="#{worker._Organization}, #{worker._FormattedName}"
										itemValue="#{worker}" />
								</p:selectOneMenu>
							</div>
						</div>
					</div>

					<div class="modal-footer">
						<c:if test="#{!cc.attrs.headWorkers.isEmpty()}">
							<p:commandButton value="#{msg.SAVE}" action="#{cc.attrs.action}"
								styleClass="btn btn-default"
								oncomplete="$('.#{cc.attrs.selectorClass}').modal('hide');"
								update="#{cc.attrs.update}" />
						</c:if>
					</div>
				</h:panelGroup>
			</div>
		</div>
	</div>
</composite:implementation>
</html>